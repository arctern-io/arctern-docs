

<!DOCTYPE html>
<html class="writer-html5" lang="python" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>arctern.geodataframe.geodataframe &mdash; Arctern 0.3.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> Arctern
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../quick_start/quick_start.html">快速开始</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../feature_description/feature_description.html">功能说明</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_reference/api_reference.html">API 参考</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cluster/cluster.html">从单机过渡到分布式</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../restful/restful.html">RESTful 服务</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Arctern</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>arctern.geodataframe.geodataframe</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for arctern.geodataframe.geodataframe</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright (C) 2019-2020 Zilliz. All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>

<span class="c1"># pylint: disable=too-many-lines</span>
<span class="c1"># pylint: disable=too-many-public-methods, unused-argument, redefined-builtin,protected-access</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">zip_longest</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">Series</span>
<span class="kn">from</span> <span class="nn">arctern</span> <span class="kn">import</span> <span class="n">GeoSeries</span>
<span class="kn">import</span> <span class="nn">arctern.tools</span>


<div class="viewcode-block" id="GeoDataFrame"><a class="viewcode-back" href="../../../api_reference/standalone_api/api/arctern.GeoDataFrame.html#arctern.GeoDataFrame">[docs]</a><span class="k">class</span> <span class="nc">GeoDataFrame</span><span class="p">(</span><span class="n">DataFrame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A GeoDataFrame object is a pandas.DataFrame that has columns</span>
<span class="sd">    with geometry. In addition to the standard DataFrame constructor arguments,</span>
<span class="sd">    GeoDataFrame also accepts the following keyword arguments:</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    crs : value (optional)</span>
<span class="sd">        Coordinate Reference System of the geometry objects.</span>
<span class="sd">    geometries : list</span>
<span class="sd">        The name of columns which are setten as geometry columns.</span>
<span class="sd">    data : ndarray (structured or homogeneous), Iterable, dict, or DataFrame</span>
<span class="sd">        Dict can contain Series, GeoSeries, arrays, constants, or list-like objects.</span>

<span class="sd">        .. versionchanged:: 0.23.0</span>
<span class="sd">           If data is a dict, column order follows insertion-order for</span>
<span class="sd">           Python 3.6 and later.</span>

<span class="sd">        .. versionchanged:: 0.25.0</span>
<span class="sd">           If data is a list of dicts, column order follows insertion-order</span>
<span class="sd">           for Python 3.6 and later.</span>

<span class="sd">    index : Index or array-like</span>
<span class="sd">        Index to use for resulting frame. Will default to RangeIndex if</span>
<span class="sd">        no indexing information part of input data and no index provided.</span>
<span class="sd">    columns : Index or array-like</span>
<span class="sd">        Column labels to use for resulting frame. Will default to</span>
<span class="sd">        RangeIndex (0, 1, 2, ..., n) if no column labels are provided.</span>
<span class="sd">    dtype : dtype, default None</span>
<span class="sd">        Data type to force. Only a single dtype is allowed. If None, infer.</span>
<span class="sd">    copy : bool, default False</span>
<span class="sd">        Copy data from inputs. Only affects DataFrame / 2d ndarray input.</span>

<span class="sd">    Examples</span>
<span class="sd">    ---------</span>
<span class="sd">    &gt;&gt;&gt; from arctern import GeoDataFrame</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; data = {</span>
<span class="sd">    ...     &quot;A&quot;: range(5),</span>
<span class="sd">    ...     &quot;B&quot;: np.arange(5.0),</span>
<span class="sd">    ...     &quot;other_geom&quot;: [1, 1, 1, 2, 2],</span>
<span class="sd">    ...     &quot;geo1&quot;: [&quot;POINT (0 0)&quot;, &quot;POINT (1 1)&quot;, &quot;POINT (2 2)&quot;, &quot;POINT (3 3)&quot;, &quot;POINT (4 4)&quot;],</span>
<span class="sd">    ... }</span>
<span class="sd">    &gt;&gt;&gt; gdf = GeoDataFrame(data, geometries=[&quot;geo1&quot;], crs=[&quot;epsg:4326&quot;])</span>
<span class="sd">    &gt;&gt;&gt; gdf</span>
<span class="sd">       A    B  other_geom         geo1</span>
<span class="sd">    0  0  0.0           1  POINT (0 0)</span>
<span class="sd">    1  1  1.0           1  POINT (1 1)</span>
<span class="sd">    2  2  2.0           1  POINT (2 2)</span>
<span class="sd">    3  3  3.0           2  POINT (3 3)</span>
<span class="sd">    4  4  4.0           2  POINT (4 4)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">geometries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">geometry_column_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">crs_for_cols</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">GeoSeries</span><span class="p">):</span>
            <span class="n">crs_for_cols</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">crs</span>
            <span class="n">geometry_column_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">GeoSeries</span><span class="p">):</span>
                    <span class="n">crs_for_cols</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">crs</span>
                    <span class="n">geometry_column_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GeoDataFrame</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">copy</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_geometry_column_names</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_crs_for_cols</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_geometry_column_names</span> <span class="o">=</span> <span class="n">geometry_column_names</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_crs_for_cols</span> <span class="o">=</span> <span class="n">crs_for_cols</span>
        <span class="k">if</span> <span class="n">geometries</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">geometries</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">crs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">crs</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">crs</span> <span class="o">=</span> <span class="p">[</span><span class="n">crs</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">geometries</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">crs</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The type of crs should be str or list!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">geometries</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">crs</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The length of crs should less than geometries!&quot;</span><span class="p">)</span>

        <span class="c1"># align crs and cols, simply fill None to crs</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">_crs</span> <span class="ow">in</span> <span class="n">zip_longest</span><span class="p">(</span><span class="n">geometries</span><span class="p">,</span> <span class="n">crs</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_geometry_column_names</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">GeoSeries</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">_crs</span><span class="p">)</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">invalidate_sindex</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_crs_for_cols</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">_crs</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_geometry_column_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

    <span class="c1"># pylint: disable=protected-access</span>
<div class="viewcode-block" id="GeoDataFrame.set_geometry"><a class="viewcode-back" href="../../../api_reference/standalone_api/api/arctern.GeoDataFrame.set_geometry.html#arctern.GeoDataFrame.set_geometry">[docs]</a>    <span class="k">def</span> <span class="nf">set_geometry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets an existing column in the GeoDataFrame to a geometry column, which is used to perform geometric calculations later.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        col: list</span>
<span class="sd">            The name of column to be setten as a geometry column.</span>
<span class="sd">        inplace: bool, default false</span>
<span class="sd">            Whether to modify the GeoDataFrame in place.</span>

<span class="sd">            * *True:* Modifies the GeoDataFrame in place (does not create a new object).</span>
<span class="sd">            * *False:* Does not modifies the GeoDataFrame in place.</span>

<span class="sd">        crs: str</span>
<span class="sd">            The coordinate reference system to use.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GeoDataFrame</span>
<span class="sd">            A GeoDataFrame object.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from arctern import GeoDataFrame</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; data = {</span>
<span class="sd">        ...    &quot;A&quot;: range(5),</span>
<span class="sd">        ...    &quot;B&quot;: np.arange(5.0),</span>
<span class="sd">        ...    &quot;geo1&quot;: [&quot;POINT (0 0)&quot;, &quot;POINT (1 1)&quot;, &quot;POINT (2 2)&quot;, &quot;POINT (3 3)&quot;, &quot;POINT (4 4)&quot;],</span>
<span class="sd">        ...    &quot;geo2&quot;: [&quot;POINT (0 0)&quot;, &quot;POINT (1 1)&quot;, &quot;POINT (2 2)&quot;, &quot;POINT (3 3)&quot;, &quot;POINT (4 4)&quot;],</span>
<span class="sd">        ... }</span>
<span class="sd">        &gt;&gt;&gt; gdf = GeoDataFrame(data, geometries=[&quot;geo1&quot;], crs=[&quot;epsg:4326&quot;])</span>
<span class="sd">        &gt;&gt;&gt; gdf.geometries_name</span>
<span class="sd">        [&#39;geo1&#39;]</span>
<span class="sd">        &gt;&gt;&gt; gdf.set_geometry(col=&quot;geo2&quot;,crs=&quot;epsg:4326&quot;,inplace=True).geometries_name</span>
<span class="sd">        [&#39;geo1&#39;, &#39;geo2&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">geometry_cols</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">_geometry_column_names</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">GeoSeries</span><span class="p">):</span>
            <span class="n">frame</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">GeoSeries</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>
            <span class="n">geometry_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_crs_for_cols</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">crs</span>
        <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">geometry_cols</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">crs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_crs_for_cols</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">crs</span>
                <span class="n">frame</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_crs</span><span class="p">(</span><span class="n">crs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">frame</span></div>

    <span class="c1"># pylint: disable=arguments-differ</span>
<div class="viewcode-block" id="GeoDataFrame.to_json"><a class="viewcode-back" href="../../../api_reference/standalone_api/api/arctern.GeoDataFrame.to_json.html#arctern.GeoDataFrame.to_json">[docs]</a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="s2">&quot;null&quot;</span><span class="p">,</span> <span class="n">show_bbox</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a GeoJSON string representation of the GeoDataFrame.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        na: {&#39;null&#39;, &#39;drop&#39;, &#39;keep&#39;}</span>
<span class="sd">            Indicates how to output missing (NaN) values in the GeoDataFrame, by default &#39;null&#39;.</span>

<span class="sd">            * &#39;null&#39;: Outputs the missing entries as JSON null.</span>
<span class="sd">            * &#39;drop&#39;: Removes the property from the feature. This applies to each feature individually so that features may have different properties.</span>
<span class="sd">            * &#39;keep&#39;: Outputs the missing entries as NaN.</span>

<span class="sd">        show_bbow: bool, optional</span>
<span class="sd">            Indicates whether to include bbox (bounding box) in the GeoJSON string, by default False.</span>

<span class="sd">            * *True:* Includes bounding box in the GeoJSON string.</span>
<span class="sd">            * *False:* Don&#39;t include bounding box in the GeoJSON string.</span>

<span class="sd">        geometry: str</span>
<span class="sd">            The name of geometry column.</span>

<span class="sd">        **kwargs:</span>
<span class="sd">            Parameters to pass to ``jump.dumps``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Series</span>
<span class="sd">            Sequence of geometries in GeoJSON format.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from arctern import GeoDataFrame</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; data = {</span>
<span class="sd">        ...     &quot;A&quot;: range(1),</span>
<span class="sd">        ...     &quot;B&quot;: np.arange(1.0),</span>
<span class="sd">        ...     &quot;other_geom&quot;: range(1),</span>
<span class="sd">        ...     &quot;geometry&quot;: [&quot;POINT (0 0)&quot;],</span>
<span class="sd">        ... }</span>
<span class="sd">        &gt;&gt;&gt; gdf = GeoDataFrame(data, geometries=[&quot;geometry&quot;], crs=[&quot;epsg:4326&quot;])</span>
<span class="sd">        &gt;&gt;&gt; gdf.to_json(geometry=&quot;geometry&quot;)</span>
<span class="sd">        &#39;{&quot;type&quot;: &quot;FeatureCollection&quot;, &quot;features&quot;: [{&quot;id&quot;: &quot;0&quot;, &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: {&quot;A&quot;: 0, &quot;B&quot;: 0.0, &quot;other_geom&quot;: 0}, &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [0.0, 0.0]}}]}&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_to_geo</span><span class="p">(</span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="p">,</span> <span class="n">show_bbox</span><span class="o">=</span><span class="n">show_bbox</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_to_geo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="s2">&quot;null&quot;</span><span class="p">,</span> <span class="n">show_bbox</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">geo</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
            <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iterfeatures</span><span class="p">(</span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="p">,</span> <span class="n">show_bbox</span><span class="o">=</span><span class="n">show_bbox</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">show_bbox</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">geo</span><span class="p">[</span><span class="s2">&quot;bbox&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">geometry</span><span class="p">]</span><span class="o">.</span><span class="n">envelope_aggr</span><span class="p">()</span><span class="o">.</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">geo</span>

    <span class="k">def</span> <span class="nf">iterfeatures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="s2">&quot;null&quot;</span><span class="p">,</span> <span class="n">show_bbox</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">na</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;null&quot;</span><span class="p">,</span> <span class="s2">&quot;drop&quot;</span><span class="p">,</span> <span class="s2">&quot;keep&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unknown na method </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">na</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">geometry</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_geometry_column_names</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> is not a geometry column&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">geometry</span><span class="p">))</span>
        <span class="n">ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">geometries</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">geometry</span><span class="p">]</span><span class="o">.</span><span class="n">as_geojson</span><span class="p">()</span>
        <span class="n">geometries_bbox</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">geometry</span><span class="p">]</span><span class="o">.</span><span class="n">bbox</span>

        <span class="n">propertries_cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">difference</span><span class="p">([</span><span class="n">geometry</span><span class="p">])</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">propertries_cols</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">properties</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">propertries_cols</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
            <span class="k">if</span> <span class="n">na</span> <span class="o">==</span> <span class="s2">&quot;null&quot;</span><span class="p">:</span>
                <span class="n">properties</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">propertries_cols</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">properties</span><span class="p">):</span>
                <span class="n">geom</span> <span class="o">=</span> <span class="n">geometries</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">na</span> <span class="o">==</span> <span class="s2">&quot;drop&quot;</span><span class="p">:</span>
                    <span class="n">propertries_items</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">propertries_cols</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                    <span class="p">}</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">propertries_items</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">propertries_cols</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
                        <span class="n">propertries_items</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
                    <span class="c1"># propertries_items = {</span>
                    <span class="c1">#     k: v for k, v in zip(propertries_cols, row)</span>
                    <span class="c1"># }</span>

                <span class="n">feature</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="n">propertries_items</span><span class="p">,</span>
                    <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">geom</span><span class="p">)</span> <span class="k">if</span> <span class="n">geom</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="p">}</span>

                <span class="k">if</span> <span class="n">show_bbox</span><span class="p">:</span>
                    <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;bbox&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">geometries_bbox</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">yield</span> <span class="n">feature</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">fid</span><span class="p">,</span> <span class="n">geom</span><span class="p">,</span> <span class="n">bbox</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ids</span><span class="p">,</span> <span class="n">geometries</span><span class="p">,</span> <span class="n">geometries_bbox</span><span class="p">):</span>
                <span class="n">feature</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">fid</span><span class="p">),</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{},</span>
                    <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="n">geom</span><span class="p">,</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="n">show_bbox</span><span class="p">:</span>
                    <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;bbox&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bbox</span> <span class="k">if</span> <span class="n">geom</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="k">yield</span> <span class="n">feature</span>

    <span class="c1"># pylint: disable=protected-access</span>
    <span class="k">def</span> <span class="nf">reset_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">col_level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col_fill</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="n">df</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">GeoDataFrame</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">drop</span><span class="p">,</span> <span class="n">inplace</span><span class="p">,</span> <span class="n">col_level</span><span class="p">,</span> <span class="n">col_fill</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">gdf</span> <span class="o">=</span> <span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
            <span class="n">gdf</span><span class="o">.</span><span class="n">_geometry_column_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_geometry_column_names</span>
            <span class="n">gdf</span><span class="o">.</span><span class="n">_crs_for_cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_crs_for_cols</span>
            <span class="k">return</span> <span class="n">gdf</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># pylint: disable=protected-access</span>
    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">df</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">GeoDataFrame</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="p">)</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="n">gdf</span><span class="o">.</span><span class="n">_geometry_column_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_geometry_column_names</span>
        <span class="n">gdf</span><span class="o">.</span><span class="n">_crs_for_cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_crs_for_cols</span>
        <span class="k">return</span> <span class="n">gdf</span>

    <span class="c1"># pylint: disable=protected-access</span>
    <span class="k">def</span> <span class="nf">drop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;raise&quot;</span><span class="p">,):</span>
        <span class="n">geometry_column_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_geometry_column_names</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">crs_for_cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_crs_for_cols</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">df</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">GeoDataFrame</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">inplace</span><span class="p">,</span> <span class="n">errors</span><span class="p">)</span>

        <span class="n">column_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">geometry_column_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">column_names</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_crs_for_cols</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">crs_for_cols</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_geometry_column_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">gdf</span> <span class="o">=</span> <span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
            <span class="n">gdf</span><span class="o">.</span><span class="n">_geometry_column_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_geometry_column_names</span>
            <span class="n">gdf</span><span class="o">.</span><span class="n">_crs_for_cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_crs_for_cols</span>
            <span class="k">return</span> <span class="n">gdf</span>
        <span class="k">return</span> <span class="kc">None</span>


<div class="viewcode-block" id="GeoDataFrame.to_geopandas"><a class="viewcode-back" href="../../../api_reference/standalone_api/api/arctern.GeoDataFrame.to_geopandas.html#arctern.GeoDataFrame.to_geopandas">[docs]</a>    <span class="k">def</span> <span class="nf">to_geopandas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transforms an arctern.GeoDataFrame object to a geopandas.GeoDataFrame object.</span>

<span class="sd">        Returns</span>
<span class="sd">        --------</span>
<span class="sd">        geopandas.GeoDataFrame</span>
<span class="sd">            A geopandas.GeoDataFrame object.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from arctern import GeoDataFrame</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; import geopandas</span>
<span class="sd">        &gt;&gt;&gt; data = {</span>
<span class="sd">        ...     &quot;A&quot;: range(5),</span>
<span class="sd">        ...     &quot;B&quot;: np.arange(5.0),</span>
<span class="sd">        ...     &quot;other_geom&quot;: range(5),</span>
<span class="sd">        ...     &quot;geo1&quot;: [&quot;POINT (0 0)&quot;, &quot;POINT (1 1)&quot;, &quot;POINT (2 2)&quot;, &quot;POINT (3 3)&quot;, &quot;POINT (4 4)&quot;],</span>
<span class="sd">        ...     &quot;geo2&quot;: [&quot;POINT (0 0)&quot;, &quot;POINT (1 1)&quot;, &quot;POINT (2 2)&quot;, &quot;POINT (3 3)&quot;, &quot;POINT (4 4)&quot;],</span>
<span class="sd">        ... }</span>
<span class="sd">        &gt;&gt;&gt; gdf = GeoDataFrame(data, geometries=[&quot;geo1&quot;, &quot;geo2&quot;], crs=[&quot;epsg:4326&quot;, &quot;epsg:3857&quot;])</span>
<span class="sd">        &gt;&gt;&gt; pdf = gdf.to_geopandas()</span>
<span class="sd">        &gt;&gt;&gt; pdf.set_geometry(&quot;geo1&quot;, inplace=True)</span>
<span class="sd">        &gt;&gt;&gt; pdf.geometry.name</span>
<span class="sd">        &#39;geo1&#39;</span>
<span class="sd">        &gt;&gt;&gt; type(pdf[&quot;geo1&quot;])</span>
<span class="sd">        &lt;class &#39;geopandas.geoseries.GeoSeries&#39;&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">geopandas</span>
        <span class="n">copy_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_geometry_column_names</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_geometry_column_names</span><span class="p">:</span>
                <span class="n">copy_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">copy_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">to_geopandas</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">copy_df</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">copy_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span></div>

    <span class="c1"># pylint: disable=protected-access</span>
<div class="viewcode-block" id="GeoDataFrame.from_geopandas"><a class="viewcode-back" href="../../../api_reference/standalone_api/api/arctern.GeoDataFrame.from_geopandas.html#arctern.GeoDataFrame.from_geopandas">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_geopandas</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">gdf</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs an arctern.GeoDataFrame object from a geopandas.GeoDataFrame object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pdf: geopandas.GeoDataFrame</span>
<span class="sd">            A geopandas.GeoDataFrame object.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GeoDataFrame</span>
<span class="sd">            An arctern.GeoDataFrame object.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from arctern import GeoDataFrame</span>
<span class="sd">        &gt;&gt;&gt; import geopandas</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point,LineString</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; data = {</span>
<span class="sd">        ...     &quot;A&quot;: range(5),</span>
<span class="sd">        ...     &quot;B&quot;: np.arange(5.0),</span>
<span class="sd">        ...     &quot;other_geom&quot;: range(5),</span>
<span class="sd">        ...     &quot;geometry&quot;: [Point(x, y) for x, y in zip(range(5), range(5))],</span>
<span class="sd">        ...     &quot;copy_geo&quot;: [Point(x + 1, y + 1) for x, y in zip(range(5), range(5))],</span>
<span class="sd">        ... }</span>
<span class="sd">        &gt;&gt;&gt; pdf = geopandas.GeoDataFrame(data, geometry=&quot;geometry&quot;, crs=&#39;epsg:4326&#39;)</span>
<span class="sd">        &gt;&gt;&gt; gdf = GeoDataFrame.from_geopandas(pdf)</span>
<span class="sd">        &gt;&gt;&gt; gdf.geometries_name</span>
<span class="sd">        [&#39;geometry&#39;, &#39;copy_geo&#39;]</span>
<span class="sd">        &gt;&gt;&gt; type(gdf[&quot;geometry&quot;])</span>
<span class="sd">        &lt;class &#39;arctern.geoseries.geoseries.GeoSeries&#39;&gt;</span>
<span class="sd">        &gt;&gt;&gt; gdf[&quot;geometry&quot;].crs</span>
<span class="sd">        &#39;EPSG:4326&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">geopandas</span>
        <span class="kn">import</span> <span class="nn">shapely</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pdf must be </span><span class="si">{</span><span class="n">geopandas</span><span class="o">.</span><span class="n">GeoSeries</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">gdf</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">gdf</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="n">column_names</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">column_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gdf</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">BaseGeometry</span><span class="p">):</span>
                <span class="n">geo_col</span> <span class="o">=</span> <span class="n">GeoSeries</span><span class="o">.</span><span class="n">from_geopandas</span><span class="p">(</span><span class="n">geopandas</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">gdf</span><span class="p">[</span><span class="n">col</span><span class="p">]))</span>
                <span class="n">result</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">geo_col</span>
                <span class="n">result</span><span class="o">.</span><span class="n">_geometry_column_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gdf</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">_crs_for_cols</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">crs</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">_crs_for_cols</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="GeoDataFrame.dissolve"><a class="viewcode-back" href="../../../api_reference/standalone_api/api/arctern.GeoDataFrame.dissolve.html#arctern.GeoDataFrame.dissolve">[docs]</a>    <span class="k">def</span> <span class="nf">dissolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dissolves geometries within ``by`` into a single observation.</span>

<span class="sd">        This is accomplished by applying the ``unary_union`` method to all geometries within a group.</span>

<span class="sd">        Observations associated with each ``by`` group will be aggregated using the ``aggfunc``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        by: str</span>
<span class="sd">            Column whose values define groups to be dissolved, by default None.</span>
<span class="sd">        aggfunc: function or str</span>
<span class="sd">            Aggregation function for manipulation of data associated with each group, by default &quot;first&quot;. Passed to pandas ``groupby.agg`` method.</span>
<span class="sd">        as_index: bool</span>
<span class="sd">            Whether to use the ``by`` column as the index of result, by default True.</span>

<span class="sd">            * *True:* The ``by`` column becomes the index of result.</span>
<span class="sd">            * *False:* The result uses the default ascending index that starts from 0.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GeoDataFrame</span>
<span class="sd">            A GeoDataFrame object.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from arctern import GeoDataFrame</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; data = {</span>
<span class="sd">        ...     &quot;A&quot;: range(5),</span>
<span class="sd">        ...     &quot;B&quot;: np.arange(5.0),</span>
<span class="sd">        ...     &quot;other_geom&quot;: [1, 1, 1, 2, 2],</span>
<span class="sd">        ...     &quot;geo1&quot;: [&quot;POINT (0 0)&quot;, &quot;POINT (1 1)&quot;, &quot;POINT (2 2)&quot;, &quot;POINT (3 3)&quot;, &quot;POINT (4 4)&quot;],</span>
<span class="sd">        ... }</span>
<span class="sd">        &gt;&gt;&gt; gdf = GeoDataFrame(data, geometries=[&quot;geo1&quot;], crs=[&quot;epsg:4326&quot;])</span>
<span class="sd">        &gt;&gt;&gt; gdf.dissolve(by=&quot;other_geom&quot;, col=&quot;geo1&quot;) # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">                                        geo1  A    B</span>
<span class="sd">        other_geom</span>
<span class="sd">        1           MULTIPOINT (0 0,1 1,2 2)  0  0.0</span>
<span class="sd">        2               MULTIPOINT (3 3,4 4)  3  3.0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">aggregated_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">by</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">aggfunc</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">merge_geometries</span><span class="p">(</span><span class="n">block</span><span class="p">):</span>
            <span class="n">merge_geom</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">unary_union</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">merge_geom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">by</span><span class="p">,</span> <span class="n">group_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
            <span class="n">merge_geometries</span>
        <span class="p">)</span>

        <span class="n">crs_str</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">crs</span>
        <span class="n">aggregated_geometry</span> <span class="o">=</span> <span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">geometries</span><span class="o">=</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="p">[</span><span class="n">crs_str</span><span class="p">])</span>

        <span class="n">aggregated</span> <span class="o">=</span> <span class="n">aggregated_geometry</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">aggregated_data</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">as_index</span><span class="p">:</span>
            <span class="n">aggregated</span> <span class="o">=</span> <span class="n">aggregated</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">aggregated</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">geometries_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_geometry_column_names</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">crs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The Coordinate Reference System (CRS) of arctern.GeoDataFrame.</span>

<span class="sd">        Returns</span>
<span class="sd">        --------</span>
<span class="sd">        crs: list</span>
<span class="sd">            The Coordinate Reference System (CRS).</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from arctern import GeoDataFrame</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; data = {</span>
<span class="sd">        ...    &quot;A&quot;: range(5),</span>
<span class="sd">        ...    &quot;B&quot;: np.arange(5.0),</span>
<span class="sd">        ...    &quot;geo1&quot;: [&quot;POINT (0 0)&quot;, &quot;POINT (1 1)&quot;, &quot;POINT (2 2)&quot;, &quot;POINT (3 3)&quot;, &quot;POINT (4 4)&quot;],</span>
<span class="sd">        ...    &quot;geo2&quot;: [&quot;POINT (0 0)&quot;, &quot;POINT (1 1)&quot;, &quot;POINT (2 2)&quot;, &quot;POINT (3 3)&quot;, &quot;POINT (4 4)&quot;],</span>
<span class="sd">        ... }</span>
<span class="sd">        &gt;&gt;&gt; gdf = GeoDataFrame(data, geometries=[&quot;geo1&quot;, &quot;geo2&quot;], crs=[&quot;epsg:4326&quot;, &quot;epsg:3857&quot;])</span>
<span class="sd">        &gt;&gt;&gt; gdf.crs</span>
<span class="sd">        {&#39;geo1&#39;: &#39;epsg:4326&#39;, &#39;geo2&#39;: &#39;epsg:3857&#39;}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_crs_for_cols</span>

    <span class="c1"># pylint: disable=too-many-arguments</span>
<div class="viewcode-block" id="GeoDataFrame.merge"><a class="viewcode-back" href="../../../api_reference/standalone_api/api/arctern.GeoDataFrame.merge.html#arctern.GeoDataFrame.merge">[docs]</a>    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">right</span><span class="p">,</span>
            <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span>
            <span class="n">on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">left_on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">right_on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">left_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">right_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_x&quot;</span><span class="p">,</span> <span class="s2">&quot;_y&quot;</span><span class="p">),</span>
            <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">indicator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">validate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Merges two GeoDataFrame objects with a database-style join.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        right : DataFrame or named Series</span>
<span class="sd">            Object to merge with.</span>
<span class="sd">        how : {&#39;left&#39;, &#39;right&#39;, &#39;outer&#39;, &#39;inner&#39;}, default &#39;inner&#39;</span>
<span class="sd">            Type of merge to be performed.</span>

<span class="sd">            * left: use only keys from left frame, similar to a SQL left outer join;</span>
<span class="sd">              preserve key order.</span>
<span class="sd">            * right: use only keys from right frame, similar to a SQL right outer join;</span>
<span class="sd">              preserve key order.</span>
<span class="sd">            * outer: use union of keys from both frames, similar to a SQL full outer</span>
<span class="sd">              join; sort keys lexicographically.</span>
<span class="sd">            * inner: use intersection of keys from both frames, similar to a SQL inner</span>
<span class="sd">              join; preserve the order of the left keys.</span>
<span class="sd">        on : label or list</span>
<span class="sd">           Column or index level names to join on. These must be found in both</span>
<span class="sd">           DataFrames. If ``on`` is None and not merging on indexes then this defaults</span>
<span class="sd">           to the intersection of the columns in both DataFrames.</span>
<span class="sd">        left_on : label or list, or array-like</span>
<span class="sd">            Column or index level names to join on in the left DataFrame. Can also</span>
<span class="sd">            be an array or list of arrays of the length of the left DataFrame.</span>
<span class="sd">            These arrays are treated as if they are columns.</span>
<span class="sd">        right_on : label or list, or array-like</span>
<span class="sd">            Column or index level names to join on in the right DataFrame. Can also</span>
<span class="sd">            be an array or list of arrays of the length of the right DataFrame.</span>
<span class="sd">            These arrays are treated as if they are columns.</span>
<span class="sd">        left_index : bool, default False</span>
<span class="sd">            Use the index from the left DataFrame as the join key(s). If it is a</span>
<span class="sd">            MultiIndex, the number of keys in the other DataFrame (either the index</span>
<span class="sd">            or a number of columns) must match the number of levels.</span>
<span class="sd">        right_index : bool, default False</span>
<span class="sd">            Use the index from the right DataFrame as the join key. Same caveats as</span>
<span class="sd">            left_index.</span>
<span class="sd">        sort : bool, default False</span>
<span class="sd">            Sort the join keys lexicographically in the result DataFrame. If False,</span>
<span class="sd">            the order of the join keys depends on the join type (how keyword).</span>
<span class="sd">        suffixes : tuple of (str, str), default (&#39;_x&#39;, &#39;_y&#39;)</span>
<span class="sd">            Suffix to apply to overlapping column names in the left and right</span>
<span class="sd">            side, respectively. To raise an exception on overlapping columns use</span>
<span class="sd">            (False, False).</span>
<span class="sd">        copy : bool, default True</span>
<span class="sd">            If False, avoid copy if possible.</span>
<span class="sd">        indicator : bool or str, default False</span>
<span class="sd">            If True, adds a column to output DataFrame called &quot;_merge&quot; with</span>
<span class="sd">            information on the source of each row.</span>
<span class="sd">            If string, column with information on source of each row will be added to</span>
<span class="sd">            output DataFrame, and column will be named value of string.</span>
<span class="sd">            Information column is Categorical-type and takes on a value of &quot;left_only&quot;</span>
<span class="sd">            for observations whose merge key only appears in &#39;left&#39; DataFrame,</span>
<span class="sd">            &quot;right_only&quot; for observations whose merge key only appears in &#39;right&#39;</span>
<span class="sd">            DataFrame, and &quot;both&quot; if the observation&#39;s merge key is found in both.</span>
<span class="sd">        validate : str, optional</span>
<span class="sd">            If specified, checks if merge is of specified type.</span>

<span class="sd">            * &quot;one_to_one&quot; or &quot;1:1&quot;: check if merge keys are unique in both</span>
<span class="sd">              left and right datasets.</span>
<span class="sd">            * &quot;one_to_many&quot; or &quot;1:m&quot;: check if merge keys are unique in left</span>
<span class="sd">              dataset.</span>
<span class="sd">            * &quot;many_to_one&quot; or &quot;m:1&quot;: check if merge keys are unique in right</span>
<span class="sd">              dataset.</span>
<span class="sd">            * &quot;many_to_many&quot; or &quot;m:m&quot;: allowed, but does not result in checks.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            GeoDataFrame or pandas.DataFrame</span>
<span class="sd">            Returns a GeoDataFrame if a geometry column is present; otherwise, returns a pandas DataFrame.</span>

<span class="sd">        Examples</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from arctern import GeoDataFrame</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; data1 = {</span>
<span class="sd">        ...      &quot;A&quot;: range(5),</span>
<span class="sd">        ...      &quot;B&quot;: np.arange(5.0),</span>
<span class="sd">        ...      &quot;other_geom&quot;: range(5),</span>
<span class="sd">        ...      &quot;geometry&quot;: [&quot;POINT (0 0)&quot;, &quot;POINT (1 1)&quot;, &quot;POINT (2 2)&quot;, &quot;POINT (3 3)&quot;, &quot;POINT (4 4)&quot;],</span>
<span class="sd">        ... }</span>
<span class="sd">        &gt;&gt;&gt; gdf1 = GeoDataFrame(data1, geometries=[&quot;geometry&quot;], crs=[&quot;epsg:4326&quot;])</span>
<span class="sd">        &gt;&gt;&gt; data2 = {</span>
<span class="sd">        ...      &quot;A&quot;: range(5),</span>
<span class="sd">        ...      &quot;location&quot;: [&quot;POINT (3 0)&quot;, &quot;POINT (1 6)&quot;, &quot;POINT (2 4)&quot;, &quot;POINT (3 4)&quot;, &quot;POINT (4 2)&quot;],</span>
<span class="sd">        ... }</span>
<span class="sd">        &gt;&gt;&gt; gdf2 = GeoDataFrame(data2, geometries=[&quot;location&quot;], crs=[&quot;epsg:4326&quot;])</span>
<span class="sd">        &gt;&gt;&gt; gdf1.merge(gdf2, left_on=&quot;A&quot;, right_on=&quot;A&quot;)</span>
<span class="sd">           A    B  other_geom     geometry     location</span>
<span class="sd">        0  0  0.0           0  POINT (0 0)  POINT (3 0)</span>
<span class="sd">        1  1  1.0           1  POINT (1 1)  POINT (1 6)</span>
<span class="sd">        2  2  2.0           2  POINT (2 2)  POINT (2 4)</span>
<span class="sd">        3  3  3.0           3  POINT (3 3)  POINT (3 4)</span>
<span class="sd">        4  4  4.0           4  POINT (4 4)  POINT (4 2)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="p">,</span> <span class="n">on</span><span class="p">,</span> <span class="n">left_on</span><span class="p">,</span> <span class="n">right_on</span><span class="p">,</span>
                                 <span class="n">left_index</span><span class="p">,</span> <span class="n">right_index</span><span class="p">,</span> <span class="n">sort</span><span class="p">,</span> <span class="n">suffixes</span><span class="p">,</span>
                                 <span class="n">copy</span><span class="p">,</span> <span class="n">indicator</span><span class="p">,</span> <span class="n">validate</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

        <span class="n">lsuffix</span><span class="p">,</span> <span class="n">rsuffix</span> <span class="o">=</span> <span class="n">suffixes</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">kser</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kser</span><span class="p">,</span> <span class="n">GeoSeries</span><span class="p">):</span>
                <span class="n">pick</span> <span class="o">=</span> <span class="bp">self</span>
                <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">lsuffix</span><span class="p">)</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="n">col</span> <span class="o">=</span> <span class="n">col</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">lsuffix</span><span class="p">)]</span>
                <span class="k">elif</span> <span class="n">col</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">rsuffix</span><span class="p">)</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">right</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="n">col</span> <span class="o">=</span> <span class="n">col</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">rsuffix</span><span class="p">)]</span>
                    <span class="n">pick</span> <span class="o">=</span> <span class="n">right</span>
                <span class="k">elif</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">right</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="n">pick</span> <span class="o">=</span> <span class="n">right</span>

                <span class="n">picked_crs</span> <span class="o">=</span> <span class="n">pick</span><span class="o">.</span><span class="n">_crs_for_cols</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">kser</span><span class="o">.</span><span class="n">set_crs</span><span class="p">(</span><span class="n">picked_crs</span><span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">_crs_for_cols</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">picked_crs</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># pylint: disable=protected-access</span>
<div class="viewcode-block" id="GeoDataFrame.from_file"><a class="viewcode-back" href="../../../api_reference/standalone_api/api/arctern.GeoDataFrame.from_file.html#arctern.GeoDataFrame.from_file">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs a GeoDataFrame from a file or url.</span>

<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>
<span class="sd">        filename: str</span>
<span class="sd">            File path or file handle to read from.</span>
<span class="sd">        bbox: tuple or GeoSeries</span>
<span class="sd">            Filters for geometries that spatially intersect with the provided bounding box. The bounding box can be a tuple ``(min_x, min_y, max_x, max_y)``, or a GeoSeries.</span>

<span class="sd">            * min_x: The minimum x coordinate of the bounding box.</span>
<span class="sd">            * min_y: The minimum y coordinate of the bounding box.</span>
<span class="sd">            * max_x: The maximum x coordinate of the bounding box.</span>
<span class="sd">            * max_y: The maximum y coordinate of the bounding box.</span>

<span class="sd">        mask: dict, GeoSeries</span>
<span class="sd">            Filters for geometries that spatially intersect with the geometries in ``mask``. ``mask`` should have the same crs with the GeoSeries that calls this method.</span>
<span class="sd">        rows: int or slice</span>
<span class="sd">            Rows to load.</span>

<span class="sd">            * If ``rows`` is an integer *n*, this function loads the first *n* rows.</span>
<span class="sd">            * If ``rows`` is a slice object (for example, *[start, end, step]*), this function loads rows by skipping over rows.</span>

<span class="sd">                * *start:* The position to start the slicing, by default 0.</span>
<span class="sd">                * *end:* The position to end the slicing.</span>
<span class="sd">                * *step:* The step of the slicing, by default 1.</span>

<span class="sd">        **kwargs:</span>
<span class="sd">            Parameters to be passed to the ``open`` or ``BytesCollection`` method in the fiona library when opening the file. For more information on possible keywords, type ``import fiona; help(fiona.open)``.</span>

<span class="sd">        Notes</span>
<span class="sd">        -------</span>
<span class="sd">        ``bbox`` and ``mask`` cannot be used together.</span>

<span class="sd">        Returns</span>
<span class="sd">        --------</span>
<span class="sd">        GeoDataFrame</span>
<span class="sd">            A GeoDataFrame read from file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">arctern</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">_read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="c1"># pylint: disable=protected-access</span>
<div class="viewcode-block" id="GeoDataFrame.to_file"><a class="viewcode-back" href="../../../api_reference/standalone_api/api/arctern.GeoDataFrame.to_file.html#arctern.GeoDataFrame.to_file">[docs]</a>    <span class="k">def</span> <span class="nf">to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;ESRI Shapefile&quot;</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes a GeoDataFrame to a file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        df: GeoDataFrame</span>
<span class="sd">            GeoDataFrame to be written.</span>
<span class="sd">        filename: str</span>
<span class="sd">            File path or file handle to write to.</span>
<span class="sd">        driver: str</span>
<span class="sd">            The OGR format driver used to write the vector file, by default &#39;ESRI Shapefile&#39;.</span>
<span class="sd">        schema: dict</span>
<span class="sd">            Data schema.</span>

<span class="sd">            * If specified, the schema dictionary is passed to Fiona to better control how the file is written.</span>
<span class="sd">            * If None (default), this function determines the schema based on each column&#39;s dtype.</span>
<span class="sd">        index: bool</span>
<span class="sd">            Whether to write index.</span>

<span class="sd">            * If None (default), writes the index into one or more columns only if the index is named, is a MultiIndex, or has a non-integer data type.</span>
<span class="sd">            * If True, writes index into one or more columns (for MultiIndex).</span>
<span class="sd">            * If False, no index is written.</span>
<span class="sd">        mode: str</span>
<span class="sd">            Mode of writing data to file.</span>

<span class="sd">            * &#39;a&#39;: Append</span>
<span class="sd">            * &#39;w&#39; (default): Write</span>
<span class="sd">        crs: str</span>
<span class="sd">            The coordinate reference system to use.</span>

<span class="sd">            * If specified, the CRS is passed to Fiona to better control how the file is written.</span>
<span class="sd">            * If None (default), this function determines the crs based on crs df attribute.</span>
<span class="sd">        geometry: str</span>
<span class="sd">            Specifys geometry column, by default None.</span>

<span class="sd">        **kwargs:</span>
<span class="sd">            Parameters to be passed to ``fiona.open``. Can be used to write to multi-layer data, store data within archives (zip files), etc.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The format drivers will attempt to detect the encoding of your data, but may fail. In this case, the proper encoding can be specified explicitly by using the encoding keyword parameter, e.g. ``encoding=&#39;utf-8&#39;``.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from arctern import GeoDataFrame</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; data = {</span>
<span class="sd">        ...     &quot;A&quot;: range(5),</span>
<span class="sd">        ...     &quot;B&quot;: np.arange(5.0),</span>
<span class="sd">        ...     &quot;other_geom&quot;: range(5),</span>
<span class="sd">        ...     &quot;geo1&quot;: [&quot;POINT (0 0)&quot;, &quot;POINT (1 1)&quot;, &quot;POINT (2 2)&quot;, &quot;POINT (3 3)&quot;, &quot;POINT (4 4)&quot;],</span>
<span class="sd">        ...     &quot;geo2&quot;: [&quot;POINT (1 1)&quot;, &quot;POINT (2 2)&quot;, &quot;POINT (3 3)&quot;, &quot;POINT (4 4)&quot;, &quot;POINT (5 5)&quot;],</span>
<span class="sd">        ...     &quot;geo3&quot;: [&quot;POINT (2 2)&quot;, &quot;POINT (3 3)&quot;, &quot;POINT (4 4)&quot;, &quot;POINT (5 5)&quot;, &quot;POINT (6 6)&quot;],</span>
<span class="sd">        ... }</span>
<span class="sd">        &gt;&gt;&gt; gdf = GeoDataFrame(data, geometries=[&quot;geo1&quot;, &quot;geo2&quot;], crs=[&quot;epsg:4326&quot;, &quot;epsg:3857&quot;])</span>
<span class="sd">        &gt;&gt;&gt; gdf.to_file(filename=&quot;/tmp/test.shp&quot;, geometry=&quot;geo1&quot;, crs=&quot;epsg:3857&quot;)</span>
<span class="sd">        &gt;&gt;&gt; read_gdf = GeoDataFrame.from_file(filename=&quot;/tmp/test.shp&quot;)</span>
<span class="sd">        &gt;&gt;&gt; read_gdf</span>
<span class="sd">           A    B  other_geom         geo2         geo3     geometry</span>
<span class="sd">        0  0  0.0           0  POINT (1 1)  POINT (2 2)  POINT (0 0)</span>
<span class="sd">        1  1  1.0           1  POINT (2 2)  POINT (3 3)  POINT (1 1)</span>
<span class="sd">        2  2  2.0           2  POINT (3 3)  POINT (4 4)  POINT (2 2)</span>
<span class="sd">        3  3  3.0           3  POINT (4 4)  POINT (5 5)  POINT (3 3)</span>
<span class="sd">        4  4  4.0           4  POINT (5 5)  POINT (6 6)  POINT (4 4)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arctern</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">_to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="n">driver</span><span class="p">,</span>
                                    <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_constructor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">GeoDataFrame</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_constructor_expanddim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, zilliz
      <span class="lastupdated">
        Last updated on Aug 04, 2020.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>